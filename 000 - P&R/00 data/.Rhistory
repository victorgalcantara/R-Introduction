scale_x_discrete(limits=c(0,10),breaks=seq(0,10,2))
ggplot( data = mydata , aes( x = faltas ) )+
geom_bar(fill="steelblue")+
scale_y_continuous(limits=c(0,5))
table(mydata$faltas)
class(mydata$faltas)
mydata <- mydata %>% mutate(.,
faltas = as.integer(faltas)
)
ggplot( data = mydata , aes( x = faltas ) )+
geom_bar(fill="steelblue")+
scale_y_continuous(limits=c(0,5))+
scale_x_discrete(limits=c(0,10),breaks=seq(0,10,2))+
labs(title = "Frequência absoluta por sexo",
y="Frequência absoluta",x="")+
theme_bw()
class(mydata$faltas)
ggplot( data = mydata , aes( x = faltas ) )+
geom_bar(fill="steelblue")+
scale_y_continuous(limits=c(0,5))+
scale_x_discrete(limits=c(0,10),breaks=seq(0,10,2))
ggplot( data = mydata , aes( x = faltas ) )+
geom_bar(fill="steelblue")+
scale_y_continuous(limits=c(0,5))
ggplot( data = mydata , aes( x = faltas ) )+
geom_bar(fill="steelblue")+
scale_y_continuous(limits=c(0,5))+
scale_x_discrete(limits=c(0,10),breaks=seq(0,10,2))
ggplot( data = mydata , aes( x = faltas ) )+
geom_bar(fill="steelblue")+
scale_y_continuous(limits=c(0,5))+
scale_x_continuous(limits=c(0,10),breaks=seq(0,10,2))+
labs(title = "Frequência absoluta por sexo",
y="Frequência absoluta",x="")+
theme_bw()
ggplot( data = mydata , aes( x = faltas ) )+
geom_bar(fill="steelblue")+
scale_y_continuous(limits=c(0,5))+
scale_x_continuous(limits=c(0,10),breaks=seq(0,10,2))+
labs(title = "Frequência de faltas",
y="Frequência absoluta",x="")+
theme_bw()
ggplot( data = mydata , aes( x = nota ) )+
geom_histogram(fill="steelblue")
ggplot( data = mydata , aes( x = nota ) )+
geom_histogram(fill="steelblue")+
scale_y_continuous(limits=c(0,5))
ggplot( data = mydata , aes( x = nota ) )+
geom_histogram(fill="steelblue")+
scale_y_continuous(limits=c(0,5))+
scale_x_continuous(limits=c(0,10))+
labs(title = "Frequência de faltas",
y="Frequência absoluta",x="")+
theme_bw()
ggplot( data = mydata , aes( x = nota ) )+
geom_histogram(bins = 2)+
scale_y_continuous(limits=c(0,5))+
scale_x_continuous(limits=c(0,10))+
labs(title = "Frequência de faltas",
y="Frequência absoluta",x="")+
theme_bw()
ggplot( data = mydata , aes( x = nota ) )+
geom_histogram(bins = 2)+
scale_y_continuous()+
scale_x_continuous(limits=c(0,10))+
labs(title = "Frequência de faltas",
y="Frequência absoluta",x="")+
theme_bw()
ggplot( data = mydata , aes( x = nota ) )+
geom_histogram(bins = 2)+
scale_y_continuous()+
labs(title = "Frequência de faltas",
y="Frequência absoluta",x="")+
theme_bw()
hist(mydata$nota)
ggplot( data = mydata , aes( x = nota ) )+
geom_histogram()
ggplot( data = mydata , aes( x = nota ) )+
geom_histogram(bins=10)+
scale_y_continuous()+
labs(title = "Frequência de nota",
y="Frequência absoluta",x="")+
theme_bw()
ggplot( data = mydata , aes( x = nota ) )+
geom_histogram(bins=10)+
scale_y_continuous()+
scale_x_continuous(limits = c(0,10))
ggplot( data = mydata , aes( x = nota ) )+
geom_histogram(bins=10)+
scale_y_continuous()+
scale_x_continuous(limits = c(0,10))+
labs(title = "Frequência de nota",
y="Frequência absoluta",x="Nota")+
theme_bw()
ggplot( data = mydata , aes( x = nota ) )+
geom_histogram(bins=10)+
scale_y_continuous(expand = c(0,0))+
scale_x_continuous(limits = c(0,10),expand = c(0,0))+
labs(title = "Histograma da nota",
y="Frequência absoluta",x="Nota")+
theme_bw()
ggplot( data = mydata , aes( x = nota ) )+
geom_histogram(bins=4)+
scale_y_continuous(expand = c(0,0))+
scale_x_continuous(limits = c(0,10),expand = c(0,0))+
labs(title = "Histograma da nota",
y="Frequência absoluta",x="Nota")+
theme_bw()
mydata$nota
ggplot( data = mydata , aes( x = nota ) )+
geom_histogram(bins=6)+
scale_y_continuous(expand = c(0,0))+
scale_x_continuous(limits = c(0,10),expand = c(0,0))+
labs(title = "Histograma da nota",
y="Frequência absoluta",x="Nota")+
theme_bw()
ggplot( data = mydata , aes( x = nota ) )+
geom_histogram(binwidth = 2)+
scale_y_continuous(expand = c(0,0))+
scale_x_continuous(limits = c(0,10),expand = c(0,0))+
labs(title = "Histograma da nota",
y="Frequência absoluta",x="Nota")+
theme_bw()
ggplot( data = mydata , aes( x = nota ) )+
geom_histogram(binwidth = 5)+
scale_y_continuous(expand = c(0,0))+
scale_x_continuous(limits = c(0,10),expand = c(0,0))+
labs(title = "Histograma da nota",
y="Frequência absoluta",x="Nota")+
theme_bw()
ggplot( data = mydata , aes( x = nota ) )+
geom_histogram(bins=4)+
scale_y_continuous(expand = c(0,0))+
scale_x_continuous(limits = c(0,10),expand = c(0,0))+
labs(title = "Histograma da nota",
y="Frequência absoluta",x="Nota")+
theme_bw()
ggplot( data = mydata , aes( x = nota ) )+
geom_density(bins=4)+
scale_y_continuous(expand = c(0,0))+
scale_x_continuous(limits = c(0,10),expand = c(0,0))+
labs(title = "Histograma da nota",
y="Frequência absoluta",x="Nota")+
theme_bw()
ggplot( data = mydata , aes( x = nota ) )+
geom_histogram()+
scale_y_continuous(expand = c(0,0))+
scale_x_continuous(limits = c(0,10),expand = c(0,0))+
labs(title = "Histograma da nota",
y="Frequência absoluta",x="Nota")+
theme_bw()
ggplot( data = mydata , aes( x = nota ) )+
geom_histogram(aes(fill="blue"))+
scale_y_continuous(expand = c(0,0))+
scale_x_continuous(limits = c(0,10),expand = c(0,0))+
labs(title = "Histograma da nota",
y="Frequência absoluta",x="Nota")+
theme_bw()
ggplot( data = mydata , aes( x = nota ) )+
geom_histogram(fill="blue")+
scale_y_continuous(expand = c(0,0))+
scale_x_continuous(limits = c(0,10),expand = c(0,0))+
labs(title = "Histograma da nota",
y="Frequência absoluta",x="Nota")+
theme_bw()
ggplot( data = mydata , aes( x = nota ) )+
geom_histogram(col="blue")+
scale_y_continuous(expand = c(0,0))+
scale_x_continuous(limits = c(0,10),expand = c(0,0))+
labs(title = "Histograma da nota",
y="Frequência absoluta",x="Nota")+
theme_bw()
ggplot( data = mydata , aes( x = nota ) )+
geom_histogram(col="blue")+
scale_y_continuous(expand = c(0,0))+
scale_x_continuous(limits = c(0,11),expand = c(0,0))+
labs(title = "Histograma da nota",
y="Frequência absoluta",x="Nota")+
theme_bw()
ggplot( data = mydata , aes( x = nota ) )+
geom_histogram(col="blue")+
scale_y_continuous(expand = c(0,5))+
scale_x_continuous(limits = c(0,11),expand = c(0,0))+
labs(title = "Histograma da nota",
y="Frequência absoluta",x="Nota")+
theme_bw()
ggplot( data = mydata , aes( x = nota ) )+
geom_histogram(col="blue")+
scale_y_continuous(limits = c(0,5),expand = c(0,0))+
scale_x_continuous(limits = c(0,11),expand = c(0,0))+
labs(title = "Histograma da nota",
y="Frequência absoluta",x="Nota")+
theme_bw()
notas_aleatorias <- sample(x = 1:10,size = 10000,replace = T)
alunos <- 1:10000
mydata2 <- data.frame(alunos,notas_aleatorias)
ggplot( data = mydata2 , aes( x = notas_aleatorias ) )+
geom_histogram(col="blue")+
scale_y_continuous(limits = c(0,5),expand = c(0,0))+
scale_x_continuous(limits = c(0,11),expand = c(0,0))+
labs(title = "Histograma da nota",
y="Frequência absoluta",x="Nota")+
theme_bw()
ggplot( data = mydata2 , aes( x = notas_aleatorias ) )+
geom_histogram(col="blue")+
scale_y_continuous(expand = c(0,0))+
scale_x_continuous(limits = c(0,11),expand = c(0,0))+
labs(title = "Histograma da nota",
y="Frequência absoluta",x="Nota")+
theme_bw()
notas_aleatorias
notas_aleatorias <- rnorm(n = 10000,mean = 5,sd = 2)
alunos <- 1:10000
mydata2 <- data.frame(alunos,notas_aleatorias)
ggplot( data = mydata2 , aes( x = notas_aleatorias ) )+
geom_histogram(col="blue")+
scale_y_continuous(expand = c(0,0))+
scale_x_continuous(limits = c(0,11),expand = c(0,0))+
labs(title = "Histograma da nota",
y="Frequência absoluta",x="Nota")+
theme_bw()
ggplot( data = mydata2 , aes( x = notas_aleatorias ) )+
geom_boxplot(col="blue")+
scale_y_continuous(expand = c(0,0))+
scale_x_continuous(limits = c(0,11),expand = c(0,0))+
labs(title = "Histograma da nota",
y="Frequência absoluta",x="Nota")+
theme_bw()
ggplot( data = mydata2 , aes( x = notas_aleatorias ) )+
geom_boxplot(col="blue")+
scale_y_continuous()+
scale_x_continuous(limits = c(0,11))+
labs(title = "Histograma da nota",
y="Frequência absoluta",x="Nota")+
theme_bw()
ggplot( data = mydata2 , aes( x = notas_aleatorias ) )+
geom_boxplot(col="blue")+
scale_y_continuous()+
scale_x_continuous(limits = c(0,11),breaks = seq(0,12,2))+
labs(title = "Histograma da nota",
y="Frequência absoluta",x="Nota")+
theme_bw()
ggplot( data = mydata2 , aes( x = notas_aleatorias ) )+
geom_boxplot(col="blue")+
scale_y_continuous()+
scale_x_continuous(limits = c(0,11),breaks = seq(0,12,2.5))+
labs(title = "Histograma da nota",
y="Frequência absoluta",x="Nota")+
theme_bw()
ggplot( data = mydata2 , aes( x = notas_aleatorias ) )+
geom_boxplot(col="blue")+
scale_y_continuous()+
scale_x_continuous(limits = c(0,11),breaks = seq(0,12.5,2.5))+
labs(title = "Histograma da nota",
y="Frequência absoluta",x="Nota")+
theme_bw()
ggplot( data = mydata2 , aes( x = notas_aleatorias ) )+
geom_boxplot(col="blue")+
scale_y_continuous()+
scale_x_continuous(limits = c(0,11),breaks = seq(0,12,2.5))+
labs(title = "Histograma da nota",
y="Frequência absoluta",x="Nota")+
theme_bw()
summary(mydata2$notas_aleatorias)
ggplot( data = mydata , aes( x = nse, y =  nota) )+
geom_point(col="blue")+
scale_y_continuous(expand = c(0,0))+
scale_x_continuous(limits = c(0,11),expand = c(0,0))+
labs(title = "Histograma da nota",
y="Frequência absoluta",x="Nota")+
theme_bw()
ggplot( data = mydata , aes( x = nse, y =  nota) )+
geom_point(col="blue")+
scale_y_continuous(limits = c(0,11))+
scale_x_continuous(limits = c(0,11),expand = c(0,0))+
labs(title = "Histograma da nota",
y="Nota",x="NSE")+
theme_bw()
g2 <- ggplot( data = mydata2 , aes( x = notas_aleatorias ) )+
geom_histogram(col="blue")+
scale_y_continuous(expand = c(0,0))+
scale_x_continuous(limits = c(0,11),expand = c(0,0))+
labs(title = "Histograma da nota",
y="Frequência absoluta",x="Nota")+
theme_bw()
g2 + geom_smooth(method = "lm")
g2 <- ggplot( data = mydata2 , aes( x = notas_aleatorias ) )+
geom_histogram(col="blue")+
scale_y_continuous(expand = c(0,0))+
scale_x_continuous(limits = c(0,11),expand = c(0,0))+
labs(title = "Histograma da nota",
y="Frequência absoluta",x="Nota")+
theme_bw()
g2 + geom_smooth(method = "lm")
g2
g2 <- ggplot( data = mydata2 , aes( x = notas_aleatorias ) )+
geom_histogram(col="blue")+
scale_y_continuous(expand = c(0,0))+
scale_x_continuous(limits = c(0,11),expand = c(0,0))+
labs(title = "Histograma da nota",
y="Frequência absoluta",x="Nota")+
theme_bw()
g2 + geom_smooth(method = "lm")
g2
g2 <- ggplot( data = mydata , aes( x = nse, y =  nota) )+
geom_point(col="blue")+
scale_y_continuous(limits = c(0,11))+
scale_x_continuous(limits = c(0,11),expand = c(0,0))+
labs(title = "Histograma da nota",
y="Nota",x="NSE")+
theme_bw()
g2 + geom_smooth(method = "lm")
library(plotly)
Scatter <- plot_ly(data = mydata,
x = ~nse,
y = ~nota,
z = ~faltas,
color = ~sexo,
#type = 'scatter',
mode = 'markers') %>%
layout(xaxis = list(title = "NSE"),
yaxis = list(title = "Nota"),
zaxis = list(title = "Faltas"))
plot_ly(data = mydata,
x = ~nse,
y = ~nota,
z = ~faltas,
color = ~sexo,
#type = 'scatter',
mode = 'markers') %>%
layout(xaxis = list(title = "NSE"),
yaxis = list(title = "Nota"),
zaxis = list(title = "Faltas"))
# We have to remove axis from the ggplot layers
no_axis <- theme(axis.title=element_blank(),
axis.text=element_blank(),
axis.ticks=element_blank())
library(geobr)
library(ggplot2)
library(sf)
library(dplyr)
# Depict all the Brazilian States + Federal District, 2019
states <- read_state(year=2019)
ggplot() +
geom_sf(data=states, fill="#FFDB6D", color="#293352", size=.5, show.legend = FALSE) +
labs(subtitle="States of Brazil and Federal District, 2019", size=8) +
theme_minimal() +
no_axis
# Depict all the Brazilian States + Federal District, 1920
states <- read_state(year=1920)
ggplot() +
geom_sf(data=states, fill="#FFDB6D", color="#293352", size=.5, show.legend = FALSE) +
labs(subtitle="States of Brazil and Federal District, 1920", size=8) +
theme_minimal() +
no_axis
# Depict all the Brazilian States + Federal District, 1920
states <- read_state(year=1890)
# Depict all the Brazilian States + Federal District, 1920
states <- read_state(year=1872)
ggplot() +
geom_sf(data=states, fill="#FFDB6D", color="#293352", size=.5, show.legend = FALSE) +
labs(subtitle="States of Brazil and Federal District, 1920", size=8) +
theme_minimal() +
no_axis
#Intermediate units
meso <- read_intermediate_region(year=2019)
ggplot() +
geom_sf(data=meso, fill="#FFDB6D", color="#293352", size=.15, show.legend = FALSE) +
labs(subtitle="Intermediate Stats units of Brazil, 2019", size=8) +
theme_minimal() +
no_axis
# All municipalities in Brazil
muni <- read_municipality(year=2019)
ggplot() +
geom_sf(data=muni, fill="#FFDB6D", color="#293352", size=.15, show.legend = FALSE) +
labs(subtitle="Municipalities of Brazil, 2019", size=8) +
theme_minimal() +
no_axis
# install.package(pacman)
library(pacman)
p_load(tidyverse,rio,janitor,patchwork,geobr)
# To clean memory
rm(list=ls()) # Remove all objects
gc() # Garbage Clean
# Work directories
wd_outp_intror <- "G:/Meu Drive/00 GitHub/R-Introduction/A03 - Import and Tidy Data/02 outp"
wd_data_intror <- "G:/Meu Drive/00 GitHub/R-Introduction/000 - P&R/00 data/"
# Data censo
wd_data_censo <- "G:/Meu Drive/00 data/IBGE/CENSO/SETORES CENSO/"
# Population census
basico_SP2 <- import(file = paste0(wd_data_censo,"/SP_Exceto_a_Capital_20190207/CSV/Basico_SP2.csv"))
Pessoa03_SP <- import(file = paste0(wd_data_censo,"/SP_Exceto_a_Capital_20190207/CSV/Pessoa03_SP.csv"))
# Geographic data of SP State
geo_sp <- read_census_tract(code_tract = 35,year = 2010)
# Dimesions
dim(Pessoa03_SP)
# Structure
str(Pessoa03_SP)
# Transformando a variável renda para métrica
basico_SP2 <- basico_SP2 %>% mutate(.,
V009 = gsub(",", ".", V009),
) %>% mutate(
V009 = as.numeric(V009)
) %>% rename(
"code_tract" = Cod_setor,
"me_rend" = V009
)
mydata1 <- basico_SP2 %>% select(code_tract,me_rend)
# Population census
basico_SP2 <- import(file = paste0(wd_data_censo,"/SP_Exceto_a_Capital_20190207/CSV/Basico_SP2.csv"))
Pessoa03_SP <- import(file = paste0(wd_data_censo,"/SP_Exceto_a_Capital_20190207/CSV/Pessoa03_SP.csv"))
# Substituindo vírgulas por pontos (notação inglesa)
basico_SP2 <- basico_SP2 %>% mutate_all(~ gsub(",", ".", .))
# Transformando a variável renda para métrica
basico_SP2 <- basico_SP2 %>%  mutate(
V009 = as.numeric(V009)
)
basico_SP2 <- basico_SP2 %>% rename(
"code_tract" = Cod_setor,
"me_rend" = V009
)
# Fazendo o mesmo com a base das pessoas
Pessoa03_SP <- Pessoa03_SP %>% mutate_all(~ gsub(",", ".", .))
View(Pessoa03_SP)
Pessoa03_SP <- Pessoa03_SP %>% mutate(.,
qt_pessoas=as.numeric(V001),
qt_brancos = as.numeric(V002),
qt_pretos = as.numeric(V003),
qt_amarelos = as.numeric(V004),
qt_pardos = as.numeric(V005),
qt_indigena = as.numeric(V006),
)
Pessoa03_SP <- Pessoa03_SP %>% mutate(
p_PPI = (qt_pretos+qt_pardos+qt_indigena)/qt_pessoas,
p_negros = (qt_pretos+qt_pardos)/qt_pessoas,
p_amarelos = qt_amarelos/qt_pessoas,
p_indigena = qt_indigena/qt_pessoas,
) %>% rename(
"code_tract" = Cod_setor
)
mydata2 <- Pessoa03_SP %>% select(code_tract,p_negros,p_PPI,qt_pessoas)
mydata <- merge(mydata1,mydata2)
mydata <- merge(geo_sp,mydata, by = "code_tract")
mydata <- mydata %>% mutate(.,me_rend_cor = me_rend*1.8309)
summary(mydata$me_rend_cor)
mydata$me_renda2 <-  cut(mydata$me_rend_cor,
breaks = c(0,1000,2000,5000,10000,max(mydata$me_rend, na.rm = T)),
labels = c("0 - 1000", "1000 - 2000",
"2000 - 5000","5000 - 10000", "+ 10000"),
ordered_result = T)
mydata$p_PPI2 <-  cut(mydata$p_PPI,
breaks = c(0,.2,.3,.4,.5,max(mydata$p_PPI, na.rm = T)),
labels = c("0 - 20%", "20% - 30% ", "30% - 40%",
"40% - 50%", "+ 50%"),
ordered_result = T)
mydata <- mydata %>% filter(code_muni == 3513009)
# We have to remove axis from the ggplot layers
no_axis <- theme(axis.title=element_blank(),
axis.text=element_blank(),
axis.ticks=element_blank())
# Mean of income
map_cotia_renda <- mydata %>% drop_na(me_renda2) %>% ggplot() +
geom_sf(aes(fill = me_renda2), show.legend = T,color=NA) +
scale_fill_manual(name="Renda média \n em Reais (R$)",
values = rev(heat.colors(6, alpha = 1.0)))+
theme_minimal()+
labs(title = "Composição Econômica")+
no_axis
map_cotia_renda
geo_schools <- read_schools(year = 2010)
geo_schools <- read_schools(year = 2020)
View(geo_schools)
schools_cotia <- geo_schools %>% filter(name_muni == "Cotia")
View(schools_cotia)
map_cotia_renda + geom_point(data = schools_cotia,
color="black",size=2,shape=17)+
map_cotia_renda + geom_point(data = schools_cotia,
color="black",size=2,shape=17)
View(schools_cotia)
map_cotia_renda + geom_sf(data = schools_cotia,
color="black",size=2,shape=17)
map_cotia_renda + geom_sf(data = schools_cotia,
color="black",size=2,shape=1)
map_cotia_renda + geom_sf(data = schools_cotia,
color="black",size=1,shape=2)
map_cotia_renda + geom_sf(data = schools_cotia,
color="black",size=1,shape=3)
map_cotia_renda + geom_sf(data = schools_cotia,
color="black",size=1,shape=4)
map_cotia_renda + geom_sf(data = schools_cotia,
color="black",size=1,shape=5)
map_cotia_renda + geom_sf(data = schools_cotia,
color="black",size=1,shape=7)
map_cotia_renda + geom_sf(data = schools_cotia,
color="black",size=1,shape=8)
map_cotia_renda + geom_sf(data = schools_cotia,
color="black",size=1,shape=1)
schools_cotia$name_school
# Olhem a minha escola
mySchool <- schools_cotia %>% filter(name_school == "SIDRONIA NUNES PIRES")
map_cotia_renda + geom_sf(data = mySchool,
color="black",size=1,shape=1)
View(schools_cotia)
# Olhem a minha escola
mySchool <- schools_cotia %>% filter(name_school %in% c("SIDRONIA NUNES PIRES",
"IDALINA GODINHO DA SILVA EM",
"IVO MARIO ISAAC PIRES PREFEITO EM"))
map_cotia_renda + geom_sf(data = mySchool,
color="black",size=1,shape=1)
map_cotia_renda + geom_sf(data = mySchool,
color="black",size=1.5,shape=1)
View(geo_sp)
